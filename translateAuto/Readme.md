# 利用ChatGPT自动翻译sgml文件


## 环境搭建：
- 目前仅在windows环境下运行验证过
- python安装selenium：`pip install selenium`
- 根据自己的Chrome版本，安装webdriver驱动。点击[国内镜像](https://registry.npmmirror.com/binary.html?path=chromedriver/)下载chromedriver_win32.zip 
- poe.com上新建一个bot，设置bot模型为ChatGPT，prompt可参考我的设置：
  > 你是一个翻译官，帮助我翻译LightDB的文档。 我会把sgml代码片段发你，帮我翻译成中文，请保留其中sgml标签。 翻译结果不要有遗漏，也不需要补充多余内容，只返回给我翻译结果。 翻译结果以代码块形式展示，并与原文的缩进保持一致。
- 用你的bot地址替换poeBot.py中`BOT_URL`常量
- 运行`python poeBot.py 'login'`，手动登录一次，生成cookie文件，以后脚本会自动登录
- 考虑bot答案的不可控，也可以直接使用我建好的bot，那么就不用替换常量了，但仍需手动登录一次获取cookie



## 使用方法：
- 将需要翻译的sgml文件放入sgml文件夹中（ps:可以放文件夹，是递归处理的）
- 执行命令: `python .\auto_trans_sgml.py .\sgml\ .\sgml\ .\sgml-cn\` （具体参数的含义可以看auto_trans_sgml.py文件最下面）
- 翻译好文件在sgml-cn中



## 可能碰到的问题
- bot答案不符合预期
  > 预期流程：我们将需要翻译的片段通过代码块发给bot，bot作为翻译工具，将翻译好的内容也是通过代码块返回，脚本通过copy按钮获取答案。如果答案不符合预期，可能要先调教一下bot，或调整prompt，且bot有4到5个模型轮换，风格会有所不同，此为不可控因素。应该可以直接使用我的bot，名为LightDBDocBoy，目前比较稳定。
- bot频繁超时
  > 超时两次以上脚本会暂停让你处理异常，建议输入'r'重启浏览器
- 翻译结果没有放在代码块中，导致无法复制
  > 脚本会自动要求bot将翻译结果放在代码块中。
  > 如果频繁异常，脚本会暂停让你处理： 1.可选择教下bot后，再输入任意值重新尝试; 2.或输入'b'让bot使用代码块（有的模型怎么都教不好，暂时也没办法，不可控）; 3.与bot对话，让他使用代码块，待返回正确答案后，点击copy，然后输入'm'，脚本会使用剪切板内容作为结果
- 内容超长，导致答案无法复制
  > 如果翻译的内容超长，请缩放浏览器，保证所有答案在一页内能看到
- 脚本工作时pc不可锁屏
- 如果脚本中止
  > 如果某种原因脚本中止，或者ctrl+c主动退出了。文本翻译了一半，那么就得手动解决，备份一份半成品，然后将已翻译部分剔除后再继续执行脚本翻译，最后手动比对后合成。